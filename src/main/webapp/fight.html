<!DOCTYPE html>
<html>
<head>
<title>预订航班</title>
<!-- Custom Theme files -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords"
	content="Govihar Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template, 
	Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />
<script type="application/x-javascript">
	 addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } 
</script>
<!-- //Custom Theme files -->
<link href="css/bootstrap.css" type="text/css" rel="stylesheet"
	media="all">
<link href="css/style.css" type="text/css" rel="stylesheet" media="all">
<link rel="stylesheet" href="css/flexslider.css" type="text/css"
	media="screen" />
<link type="text/css" rel="stylesheet" href="css/JFFormStyle-1.css" />
<!-- js -->
<script src="js/jquery.min.js"></script>
<script src="js/modernizr.custom.js"></script>
<!-- //js -->
<!-- fonts -->
<link
	href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,700,500italic,700italic,900,900italic'
	rel='stylesheet' type='text/css'>
<link
	href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic'
	rel='stylesheet' type='text/css'>
<!-- //fonts -->
<script type="text/javascript">
	$(document).ready(function() {
		$('#horizontalTab').easyResponsiveTabs({
			type : 'default', //Types: default, vertical, accordion           
			width : 'auto', //auto or any width like 600px
			fit : true
		// 100% fit in a container
		});
	});
</script>
<!--pop-up-->
<script src="js/menu_jquery.js"></script>
<!--//pop-up-->
</head>
<body>
	<!--header-->
	<div class="header">
		<div class="container">
			<div class="header-grids">
				<div class="logo">
					<h1>
						<a href="index.html"><span>航空</span>售票网站</a>
					</h1>
				</div>
				<!--navbar-header-->
				<div class="header-dropdown">
					<div class="emergency-grid">
						<ul>
							<li>联系电话 :</li>
							<li class="call">+1 234 567 8901</li>
						</ul>
					</div>
					<div class="clearfix"></div>
				</div>
				<div class="clearfix"></div>
			</div>
			<div class="nav-top">
				<div class="top-nav">
					<span class="menu"><img src="images/menu.png" alt="" /></span>
					<ul class="nav1">
						<li><a href="index.html">首页</a></li>
						<li class="active"><a href="fight.html">预订航班</a></li>
						<li><a href="about.html">关于</a></li>
						<li><a href="user.html">我的</a></li>
					</ul>
					<div class="clearfix"></div>
					<!-- script-for-menu -->
					<script>
						$("span.menu").click(function() {
							$("ul.nav1").slideToggle(300, function() {
								// Animation complete.
							});
						});
					</script>
					<!-- /script-for-menu -->
				</div>
				<div class="dropdown-grids">
					<div id="loginContainer">
						<a href="#" id="loginButton"><span>登录</span></a>
						<div id="loginBox">
							<form id="loginForm">
								<div class="login-grids">
									<div class="login-grid-left">
										<fieldset id="body">
											<fieldset>
												<label for="email">账号</label> <input type="text"
													name="email" id="username">
											</fieldset>
											<fieldset>
												<label for="password">密码</label> <input type="password"
													name="password" id="password">
											</fieldset>
										</fieldset>
										<input type="button" id="login" value="登录">
										<span><a href="#">忘记密码?</a></span>
										<div class="or-grid">
											<p>OR</p>
										</div>
										<div class="social-sits">
											<div class="button-bottom">
												<p>
													新用户? <a href="signup.html">注册</a>
												</p>
											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
	<!--//header-->
	<!-- banner -->
	<div class="banner">
		<!-- container -->
		<div class="container">
			<div class="col-md-4 banner-left">
				<section class="slider2">
					<div class="flexslider">
						<ul class="slides">
							<li>
								<div class="slider-info">
									<img src="images/1.jpg" alt="">
								</div>
							</li>
							<li>
								<div class="slider-info">
									<img src="images/2.jpg" alt="">
								</div>
							</li>
							<li>
								<div class="slider-info">
									<img src="images/3.jpg" alt="">
								</div>
							</li>
							<li>
								<div class="slider-info">
									<img src="images/4.jpg" alt="">
								</div>
							</li>
							<li>
								<div class="slider-info">
									<img src="images/2.jpg" alt="">
								</div>
							</li>
						</ul>
					</div>
				</section>
				<!--FlexSlider-->
			</div>
			<div class="col-md-8 banner-right">
				<div class="sap_tabs">
					<div class="booking-info">
						<h2>机票预订</h2>
					</div>
					<div id="horizontalTab"
						style="display: block; width: 100%; margin: 0px;">
						<ul class="resp-tabs-list">
							<li class="resp-tab-item" aria-controls="tab_item-0" role="tab"><span>单程</span></li>
							<div class="clearfix"></div>
						</ul>
						<!---->
						<div class="tab-2 resp-tab-content" aria-labelledby="tab_item-0">
							<div class="facts">
								<div class="booking-form">
									<!---strat-date-piker---->
									<link rel="stylesheet" href="css/jquery-ui.css" />
									<script src="js/jquery-ui.js"></script>
									<script>
										$(function() {
											$("#datepicker,#datepicker1")
													.datepicker();
										});
									</script>

									<!---/End-date-piker---->
									<div class="online_reservation">
										<div class="b_room">
											<div class="booking_room">
												<div class="reservation">
													<ul>
														<li class="span1_of_1 desti">
															<h5>出发地</h5>
															<div class="book_date">
																<form>
																	<span class="glyphicon glyphicon-map-marker"
																		aria-hidden="true"></span> <input id="fromAdd" type="text"
																		placeholder="Type Departure City"
																		class="typeahead1 input-md form-control tt-input"
																		required="">
																</form>
															</div>
														</li>
														<li class="span1_of_1 left desti">
															<h5>目的地</h5>
															<div class="book_date">
																<form>
																	<span class="glyphicon glyphicon-map-marker"
																		aria-hidden="true"></span> <input id="toAdd" type="text"
																		placeholder="Type Destination City"
																		class="typeahead1 input-md form-control tt-input"
																		required="">
																</form>
															</div>
														</li>
														<div class="clearfix"></div>
													</ul>
												</div>
												<div class="reservation">
													<ul>
														<li class="span1_of_1">
															<h5>出发日期</h5>
															<div class="book_date">
																<form>
																	<span class="glyphicon glyphicon-calendar"
																		aria-hidden="true"></span> <input id="startTime" type="date"
																		value="Select date" onFocus="this.value = '';"
																		onBlur="if (this.value == '') {this.value = 'Select date';}">
																</form>
															</div>
														</li>
														<div class="clearfix"></div>
													</ul>
												</div>
												<div class="reservation">
													<ul>
														<li class="span1_of_3">
															<div class="date_btn">
																<form>
																	<button type="button" class="btn btn-success" id="search">查找</button>
																</form>
															</div>
														</li>
														<div class="clearfix"></div>
													</ul>
												</div>
											</div>
											<div class="clearfix"></div>
										</div>
									</div>
									<!---->
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="clearfix"></div>
	</div>
	<!-- //container -->
	</div>
	<!-- //banner -->
	<!-- banner-bottom -->
	
	<div class="banner-bottom">
		<!-- container -->
		<div class="container">
			<div class="faqs-top-grids">
				<div class="product-grids">
					<div class="col-md-12 product-right">
						<div class="product-right-grids">
								<span>数据加载中。。。</span>
						</div>
					</div>
					<div id="pageId" class="box-footer clearfix">
					
					</div>
					<div class="clearfix"> </div>
				</div>
			</div>
		</div>
		<!-- //container -->
	</div>
	<!-- //banner-bottom -->
	<!-- popular-grids -->
	<div class="popular-grids">
		<!-- container -->
		<div class="container">
			<div class="popular-info">
				<h3>热门地点</h3>
			</div>
			<!-- slider -->
			<div class="slider">
				<div class="arrival-grids">
					<ul id="flexiselDemo1">
						<li><a href="products.html"><img src="images/a3.jpg"
								alt="" /> </a></li>
						<li><a href="products.html"><img src="images/a2.jpg"
								alt="" /> </a></li>
						<li><a href="products.html"><img src="images/a4.jpg"
								alt="" /> </a></li>
						<li><a href="products.html"><img src="images/a1.jpg"
								alt="" /> </a></li>
					</ul>
					<script type="text/javascript">
						$(window).load(function() {
							$("#flexiselDemo1").flexisel({
								visibleItems : 4,
								animationSpeed : 1000,
								autoPlay : true,
								autoPlaySpeed : 3000,
								pauseOnHover : true,
								enableResponsiveBreakpoints : true,
								responsiveBreakpoints : {
									portrait : {
										changePoint : 480,
										visibleItems : 1
									},
									landscape : {
										changePoint : 640,
										visibleItems : 2
									},
									tablet : {
										changePoint : 768,
										visibleItems : 3
									}
								}
							});
						});
					</script>
					<script type="text/javascript" src="js/jquery.flexisel.js"></script>
				</div>
			</div>
			<!-- //slider -->
		</div>
		<!-- //container -->
	</div>
	<!-- popular-grids -->
	<!-- footer -->
	<div class="footer">
		<!-- container -->
		<div class="container">
			<div class="footer-top-grids">
				<div class="footer-grids">
					<div class="col-md-3 footer-grid">
						<h4>产品</h4>
						<ul>
							<li><a href="index.html">航班时间表</a></li>
						</ul>
					</div>
					<div class="col-md-3 footer-grid">
						<h4>公司相关</h4>
						<ul>
							<li><a href="about.html">关于我们</a></li>
							<li><a href="faqs.html">常见问答</a></li>
							<!-- <li><a href="terms.html">Terms &amp; Conditions</a></li>
							<li><a href="privacy.html">Privacy </a></li>
							<li><a href="contact.html">Contact Us</a></li>
							<li><a href="#">Careers</a></li>
							<li><a href="blog.html">Blog</a></li>
							<li><a href="booking.html">Feedback</a></li> -->
						</ul>
					</div>
					<div class="col-md-3 footer-grid">
						<h4>资源</h4>
						<ul>
							<li><a href="index.html">航班预订</a></li>
							<li><a href="booking.html">取消预订</a></li>
						</ul>
					</div>
					<div class="col-md-3 footer-grid">
						<h4>更多链接</h4>
						<ul class="chf_footer_list">
							<li><a href="#">航班优惠票</a></li>
						</ul>
					</div>
					<div class="clearfix"></div>
				</div>
				<!-- news-letter -->
				<div class="news-letter">
					<div class="news-letter-grids">
						<div class="col-md-4 news-letter-grid">
							<p>
								联系电话: <span>1234-5678-901</span>
							</p>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
				<!-- //news-letter -->
			</div>
		</div>
		<!-- //container -->
	</div>
	<!-- //footer -->
	<div class="footer-bottom-grids">
		<!-- container -->
		<div class="copyright">
			<p>Copyright &copy; 2015.Company name All rights reserved.</p>
		</div>
	</div>
	<script defer src="js/jquery.flexslider.js"></script>
	<script src="js/easyResponsiveTabs.js" type="text/javascript"></script>
	<script src="js/jquery-ui.js"></script>
	<script type="text/javascript" src="js/script.js"></script>
	<script type="text/javascript">
		$(function() {
			$("#pageId").load("view/doPageUI.do",function(){
				doGetObjects();
			 });
			doInit();
			userloading();
			/* SyntaxHighlighter.all(); */
			$("#login").click(login);
			$("#search").click(doGetObjects);
			//预订航班
			$(".product-right").on("click", ".book",function(){
				var session=sessionStorage.getItem("username");
				if(session==null){
					alert("请先登录")
					return;
				}else{
					var fightId=$(this).parents("div").children("#fightId").html();
					fightId=fightId.substr(5);//截取航班编号
					location.href="f-order.html?t="+Math.random()+"&username="+session+"&fightId="+fightId;
				}
			});
		});
		$(window).load(function() {
			$('.flexslider').flexslider({
				animation : "slide",
				start : function(slider) {
					$('body').removeClass('loading');
				}
			});
		});
		//跳转获取
		function doInit(){
			$("#fromAdd").val(getQueryString("fromAdd"))
			$("#toAdd").val(getQueryString("toAdd"))
			$("#startTime").val(getQueryString("startTime"))
			doGetObjects();
		}
		//从url截取数据
		function getQueryString(name) {
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
			var r = window.location.search.substr(1).match(reg);
			if (r != null) {
				return decodeURI(r[2]);
			} else {
				return null;
			}
		}
		//查找航班
		function doGetObjects(){
			var pageCurrent = $("#pageId").data("pageCurrent");
			if (!pageCurrent)
				pageCurrent = 1;
			var params={
				fromAdd:$("#fromAdd").val(),
				toAdd:$("#toAdd").val(),
				startTime:$("#startTime").val(),
				pageCurrent:pageCurrent
			}
			/* console.log(params) */
			$.post("view/goSearch.do",params,function(result){
				doHandleResponseResult(result);
			});
		}
		function doHandleResponseResult(result) {
			if (result.state == 1) {
				doSetTableBodyRows(result.data.records);
				doSetPagination(result.data);
			} else {
				alert(result.message);
			}
		}
		function doSetTableBodyRows(records) {
			//1.获取body对象,并清空内容
			var tBody = $(".product-right");
			tBody.empty();
			//2.迭代records元素,将内容添加到body
			for ( var i in records) {
				//2.1.创建对象
				var tr = $("<div class='product-right-grids'></div>");
				tr.data("rowData", records[i]);
				//2.2创建元素
				var tds = doCreateTds(records[i]);
				//2.3将tr追加到tr中
				tr.append(tds);
				//2.4将tr追加到tbody中
				tBody.append(tr);
			}
		}
		function doCreateTds(data) {
			var tds = "<div class='product-right-top'><div class='p-left'><div class='p-right-img'>"
					+"<img alt='' src='images/fi.jpg' style=' height: 200px;width: 200px'></div></div>"
					+"<div class='p-right'><div class='col-md-6 p-right-left'>"
					+"<h2>from："+data.fromAdd+"</h2>"
					+"<h4>出发时间："+new Date(data.startTime).toLocaleString()+"</h4>"
					+"<h2>to："+data.toAdd+"</h2>"
					+"<h4>预计到达时间："+new Date(data.arrTime).toLocaleString()+"</h4>"
					+"<h5 style=' color: red; margin-top: 20px'>折扣："+data.sysSeat.rebate+"</h5>"
					+"</div><div class='col-md-6 p-right-right'>"
					+"<h6 id='fightId'>航班编号:"+data.sysSeat.fightId+"</h6>"
					+"<span class='p-offer'>一等座: ￥"+data.sysSeat.fprice+"</span><div class='clearfix'> </div>"
					+"<span class='p-offer'>二等座: ￥"+data.sysSeat.sprice+"</span><div class='clearfix'> </div>"
					+"<span class='p-offer'>三等座: ￥"+data.sysSeat.oprice+"</span><div class='clearfix'> </div>"
					+"<button type='button' class='book btn btn-success' id='book'>预订</button>"
					+"</div><div class='clearfix'> </div></div><div class='clearfix'> </div></div>";
			return tds;
		}
		//登录
		function login(){
			var username=$("#username").val()
			var params={
					username:$("#username").val(),
					password:$("#password").val()
			}
			$.post("view/goLogin.do",params,function(result){
				if(result.state==1){
					alert(result.message)
					sessionStorage.setItem("username",username);
					window.location.href ="fight.html";
				}else{
					alert(result.message)
				}
			});
		}
		//替换登录组件
		function userloading(){
			var username=sessionStorage.getItem("username")
			if(username!=null){
				var input=$("#loginContainer");
				input.empty();
				input.append("<a id='userinput' href='user.html'><span>我的</span></a>"
						+"<a id='userinput' href='javascript:quit()'><span>退出</span></a>")
			}
		}
		//退出
		function quit(){
			alert("再见")
			sessionStorage.clear();
			window.location.href ="fight.html";
		}
	</script>
</body>
</html>